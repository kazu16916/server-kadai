# 様々な脆弱性や攻撃手法、方法
## 題名：admin権限へのsqlインジェクション
### ページ名: ログインページ  
### URL: http://localhost:8088/login.php  
### 手法: ユーザ名に該当するユーザ名、パスワードに「' OR 1=1」を入力しログイン  
### 結果: admin権限にパスワードを知らずにもログインできる
## 題名：コメントへのxss
### ページ名：結果出力ページ
### URL: 投票を作成、投票する必要がございます。その後結果ページに遷移ください
### 手法: 「<img src=x onerror=alert(document.cookie)>」でログインしているセッション取得
### 結果:本来取得できないセッション情報の取得。（後ほどこの機能を使用しログインします）
## 題名：ヘルプドキュメントへのディレクトリトラバーサル攻撃
### ページ名: ヘルプページ
### URL: http://localhost:8088/view_doc.php?page=usage.txt
### 手法: usage.txtを「../db.php」にし、データベース情報の取得
### 結果: 本来アクセスを許可されていないディレクトリやファイルにアクセス
## 題名: admin権限へのセッションハイジャック 
### ①admin権限へログイン、コメント欄に「<img src=x onerror=alert(document.cookie)>」と入力し、PHPSESSID=に続く文字列をコピーする。
### ②adminユーザはログアウトせず、別ブラウザで一般ユーザにログイン
### ③一般ユーザにログイン後、F12を押し開発者ツールを開く。cookie値を先ほどコピーしたものに変える。その後リロードすればadmin権限へアクセスされる
### 結果: xssの組み合わせでパスワードなしでadmin権限へログイン
## 題名: ブラインドSQLインジェクション
### ページ名: プロフィールページ
### URL: http://localhost:8088/profile.php
### 手法: リンクを「http://localhost:8088/profile.php?id=1 AND (SELECT 1 FROM users WHERE username = 'admin')」に変更。
### 結果: username=hanzawaは存在するので、AND以下のsqlでadminというユーザネームが存在すると判断されてしまう
## 題名: ログ管理ツールを使用したOSインジェクション
### ページ名: ユーザー活動ログ検索ページ
### URL: http://localhost:8088/diag.php(admin限定)
### 手法: 入力欄に「admin' ; cat db.php #」入力しを検索
### 結果: ディレクトリトラバーサル攻撃と同様にアクセス許可されていないファイルやディレクトリを参照
## 題名: profileページのファイルアップロードの脆弱性
### ページ名: プロフィールページ
### URL: http://localhost:8088/profile.php
### 手法: アップロードに画像ではなく、「php/tools/info.php」をアップロード
### 結果: 「http://localhost:8088/uploads/info.php」にアクセスするとphpの情報が見れる。（相手のディレクトリに不正なファイルを送り込む）
## 題名: エラーメッセージの情報漏洩
### ページ名: 攻撃シミュレーションツールページ
### URL①: http://localhost:8088/simulation_tools.php
### 手法①: adminログイン後、攻撃シミュレーションツールページに移動し、別タブでadminにもう一度ログイン（一度ログインしたのでlistにリダイレクト）
### 手法②: listのページをログアウトし、攻撃シミュレーションツールページをリロードするとエラーメッセージが出力される。
### 結果: サーバ上のドキュメントルートやディレクトリ構成が漏洩する。
# 攻撃機能の使い方
## 題名: ドライブバイダウンロード
### URL: http://localhost:8088/driveby_landing.php
### 手法: admin,一般ユーザいずれかにログインし、headerの提供プログラムに遷移すると勝手にダウンロードが開始される。
### ※デバイスの設定において保存場所を確認される場合があるが、そのままダウンロードを押すか、ダウンロードされることが分かれば×で閉じてもらったら結構です。
## 題名: 攻撃シミュレーションツール(admin専用)
### 機能①: グローバルIPアドレスを使用できないため、IPSのブロックや、バックドアにてこのIPアドレスシミュレーションを使用し、IPアドレスを模擬的に設定します。
### 機能②: 辞書攻撃、総当たり攻撃、バックドア、キーロガーなどを有効にします。
## 題名: ログイン機能への辞書攻撃(admin専用)
### ①「http://localhost:8088/simulation_tools.php」へadminでアクセスし、辞書攻撃を有効化にする。（表示が無効化であれば有効です。）
### ②ログアウトし、「password,qwerty,example,test,sample,admin,test123,administrator」が辞書として登録されているので、そのパスワードのユーザを登録する。
### ③先ほど登録したユーザ名を入力するか、登録しなかった場合、「admin」を入力し、辞書攻撃開始ボタンを押す。
### ④パスワードがクラックされたら自動入力されるので、そのままログインを押す。
## 題名: ログイン機能への総当たり攻撃(admin専用)
### ①「http://localhost:8088/simulation_tools.php」へadminでアクセスし、総当たり攻撃を有効化にする。（表示が無効化であれば有効です。）
### ②先ほど説明したブラインドSQLインジェクションを利用し、「http://localhost:8088/profile.php?id=1 AND (SELECT LENGTH(password) FROM users WHERE username='admin') = ??」'??'の部分に1~15を入れパスワードの桁数を検知する。ユーザ名は適宜変更してください。デフォルトではadminとhanzawaがございます。
### ③ログアウトし、ユーザ名に「admin」または「hanzawa」と入力する。先ほど取得したユーザ名のパスワード桁数を選択し、総当たり攻撃を開始する。
## 題名: 逆総当たり攻撃(admin専用)
### ①「http://localhost:8088/simulation_tools.php」へadminでアクセスし、逆総当たり攻撃を有効化にする。（表示が無効化であれば有効です。）
### ②ログアウトし、逆総当たり対象パスワードに「' OR 1=1」を入力。演習目的なので、「' OR "1"="1"」や「' OR ""=""」などは許可しておりません。お間違えないようにご入力ください。
### ③逆総当たり攻撃開始ボタンをクリックし、攻撃を開始するとアラートが出ますので、OKを押します
### ④以前説明いたしました通り「' OR 1=1」はパスワードを不要とするSQLインジェクションですので、登録されているユーザがすべて出力されます。
### ⑤発見されたアカウントのどれか一つを選択いただきログインします。
## 題名: ジョーアカウント攻撃（様々なユーザ名を幅広く列挙し、そこに一般的なパスワードを試し不正ログインを試みる）
### ①「http://localhost:8088/simulation_tools.php」へadminでアクセスし、ジョーアカウント攻撃を有効化にする。（表示が無効化であれば有効です。）
### ② ログアウトし、下にスクロール後、ユーザ名パターンに「a」と入力。
### ③ ジョーアカウント攻撃を開始ボタンを押す。
### ④ パスワードは「' OR 1=1」で試すようにしてあるため、「a」という文字が含まれているadminが出力されログインが可能です。
## 題名: 一度ログインしたらバックドアを仕掛ける攻撃演習
### ①「http://localhost:8088/simulation_tools.php」へadminでアクセスし、IPアドレスシミュレーションにて、４つのうちから一つを選び、模擬的にその攻撃者になり、下スクロール後、バックドアを有効化にする。（表示が無効化であれば有効です。）
### ※adminへの最初のログイン方法は先ほど説明したもので可能ですので、総当たり攻撃される場合は総当たり攻撃の有効化をお願いします。
### ②ログアウトし、現在の模擬IPなどが表示されているはずですので、ユーザ名を「admin」と入力し、SQLインジェクションまたは、総当たり攻撃でログイン。
### ③ログイン後もう一度ログアウトすると、パスワードなしでログインが可能です。
## 題名: ログイン画面のキーロガー
### ①「http://localhost:8088/simulation_tools.php」へadminでアクセスし、IPアドレスシミュレーションにて、キーロガーを有効化する。
### ②ログアウト後別のブラウザを立ち上げ、「http://localhost:8088/simulation_tools.php」にてキーロガーが有効になっているか確認。
### ③ヘッダーに攻撃者コンソールがございますので、遷移する。（半分半分でどちらも見えるようにすると演習としてわかりやすいです。）
### ④ユーザ名とパスワードを入力。
### ⑤攻撃者コンソールをリロードすると入力した文字がキャプチャされる。
## 題名: ランサムウェア演習
### ①「http://localhost:8088/simulation_tools.php」へadminでアクセスし、IPアドレスシミュレーションにて、ランサムウェアを有効化する。
### ②headerのランサムウェア演習に遷移する。
### ③防御ダッシュボードを別タブで開く。（半分半分でどちらも見えるようにすると演習としてわかりやすいです。）
### ③攻撃者ページでファイルの暗号化を押す。（確認アラートはOK）
### ④防御ダッシュボードをリロードし、暗号化されているのを確認する。
### ⑤防御ダッシュボードの身代金を払うボタンを押す。
### ⑥攻撃者ページに戻り、支払い確認（攻撃者）ページに遷移し、支払いを確認後、支払いを確認ボタンを押し、復旧させる。
### ⑦防御ダッシュボードをリロードし、複合化されていることを確認する
## 題名: 改ざん検知演習
### ①http://localhost:8088/simulation_tools.php」へadminでアクセスし、IPアドレスシミュレーションにて、改ざん攻撃演習を有効化する。
### ②headerの改ざん攻撃演習に遷移する
### ③防御画面で検証するボタンを押す。（半分半分でどちらも見えるようにすると演習としてわかりやすいです。）
### ④ベースライン（事前ハッシュ）の作成/更新ボタンを押し、現在の正しいハッシュ値を作成する。
### ⑤攻撃画面で任意のファイル、内容の上書を選択し、改ざんを実行する。
### ⑥防御画面をリロードし、改ざんされていることを確認する。（模擬的プロジェクトなので、改ざんを復元する機能は省きます）
